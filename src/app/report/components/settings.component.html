@if (!!form) {
  <section class="settings">
    <div class="header">
      <h3>Settings</h3>
    </div>

    <form [formGroup]="form" (ngSubmit)="apply($event)">
      <h4>Player Info</h4>
      <div>
        <mat-form-field class="fill" appearance="outline">
          <mat-label>Gear Haste Rating</mat-label>
          <input type="number" formControlName="hasteRating" matInput [min]="0" [max]="2000"/>
          @if (form.controls.hasteRating.disabled) {
            <mat-hint class="table-accent">
              Set from summary information in the log.
            </mat-hint>
          }
          @if (form.controls.hasteRating.valid) {
            <mat-hint class="table-accent">
              Missing from log.
              @if (logHasteRating !== null) {
                <span>Using saved setting.</span>
              }
              @if (logHasteRating === null) {
                <span>You can set the value manually.</span>
              }
            </mat-hint>
          }
          @if (form.controls.hasteRating.invalid) {
            <mat-error>
              Set a value between 0 and 2000.
            </mat-error>
          }
        </mat-form-field>
      </div>

      <div>
        <mat-form-field class="fill" appearance="outline">
          <mat-label>Improved Mind Blast Points</mat-label>
          <input type="number" formControlName="improvedMindBlast" matInput [min]="0" [max]="5" />
          @if (form.controls.improvedMindBlast.valid) {
            <mat-hint class="table-accent">
              How many talent points in Improved Mind Blast? (0-5)
            </mat-hint>
          }
          @if (form.controls.improvedMindBlast.invalid) {
            <mat-error>
              Enter a value between 0 and 5.
            </mat-error>
          }
        </mat-form-field>
      </div>
    </form>

    <div class="footer">
      <button mat-flat-button (click)="cancel($event)">Cancel</button>
      <button mat-flat-button color="primary" [disabled]="form.pristine || form.invalid" (click)="apply($event)">Apply</button>
    </div>
  </section>
}
